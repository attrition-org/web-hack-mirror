<html>
<head><title>Internet Security Channel</title>
</head> 
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#005283" ALINK="#999999" VLINK="#999999">
<body background="http://img.cmpnet.com/cmpnet/bgimages/btg/tw-winIE3.gif" bgcolor="#FFFFFF" link="blue" alink="purple" vlink="purple">

<!-- TOP BAN -->
<table border="0" cellpadding="0" cellspacing="0" width="600">
<tr>

<td width="129" align=center><a href="../../index.html"><img src="http://img.cmpnet.com/cmpnet/brandbars/techweb_cmp_blue.gif" alt="CMP's TechWeb" WIDTH="114" HEIGHT="57" border="0" hspace=0 align=center></a><br clear=all><img src="http://img.cmpnet.com/cmpnet/blank.gif" width=129 height=1 vspace=0 hspace=0 border=0></td>

<td width="6"><img src="http://img.cmpnet.com/cmpnet/blank.gif" width="6" height="1" border="0"></td>        
<td><img src="http://cookies.cmpnet.com/special/user/user.gif?event=9640293481508851202&ref=http://www.techweb.com:80/internetsecurity/section/11.html" width="5" height="1" border="0"><a target="_top" href="http://newads.cmpnet.com/event.ng/Type=click&ProfileID=3931&RunID=23539&AdID=17537&GroupID=1&FamilyID=2145&TagValues=163.178&Redirect=http:%2F%2Fenterprisesecurity.symantec.com%2Fjp%2Fsymesjp1.cfm%3FJID%3D2"><img src="http://img.cmpnet.com/ads/graphics/cs/ps/Symantec%20Banner3_468x60.gif" border=1 height=60 width=468 alt="Click Here to Visit Symantec"></a></td></tr>

<!-- added instead of p tag beneath -->
<tr><td colspan=3><img src="http://img.cmpnet.com/cmpnet/blank.gif" width="1" height="10" border=0 vspace=0 hspace=0></td></tr></table>



<table border="0" cellpadding="0" cellspacing="0" width="136" align="left">
<tr><td width="129"><img src="http://img.cmpnet.com/cmpnet/blank.gif" width="1" height="6" border="0"><BR>
<!-- LEFT COL NAV -->
<!-- Start leftTOC.html -->
<table border="0" width="100%" cellpadding="4" cellspacing="0">
 <tr>
  <td valign="top" width="140">
<br><b><font face="arial, helvetica"><a href="../index.html" style="text-decoration:none; color:#FFCC33">HOME</a></font></b><br>
<p><font face="arial" size="2" color="#FFCC33"><b>Just in from CMP</b></font></p>

<font size="1" face="arial,helvetica"><b>
<a href="../section/14.html" style="color:FFFFFF">CMP News</a><br><br>
<a href="../section/11.html" style="color:FFFFFF">CMP Features</a><br><br>
</font>
<p><font face="arial" size="2" color="#FFCC33"><b>Tracks</b></font></p>
<font size="1" face="arial,helvetica"><b>
<a href="../category/7.html" style="color:FFFFFF">Vulnerability Assessment</a><br><br>
<a href="../category/1.html" style="color:FFFFFF">Mobile Code Protection</a><br><br>
<a href="../category/4.html" style="color:FFFFFF">Email Content Filtering</a><br><br>
<a href="../category/3.html" style="color:FFFFFF">Internet Content Filtering</a><br><br>
<a href="../category/5.html" style="color:FFFFFF">Virus Protection</a><br><br></b>
</font>
<p><font face="arial" size="2" color="#FFCC33"><b>Resources</b></font></p>
<font size="1" face="arial,helvetica">
<a href="http://www.symantec.com/avcenter" style="color:FFFFFF">Symantec Anti-Virus Research Center</a><br><br>

<!-- COMMENTED OUT INTERNET SECURITY CHANNEL LINK
<a href="http://www.symantec.com/avcenter" style="color:FFFFFF">The Internet Security<br> Channel</a>
-->

<br><br>
</font>
<br>
<br>
<!--<img src="images/home_adleft.gif"  align="left" hspace="0" vspace="0"  alt="advertisement">-->
<a target="_top" href="http://newads.cmpnet.com/event.ng/Type=click&ProfileID=3932&RunID=23541&AdID=17536&GroupID=1&FamilyID=2146&TagValues=163.180&Redirect=http:%2F%2Fenterprisesecurity.symantec.com%2Fjp%2Fsymesjp1.cfm%3FJID%3D2"><img src="http://img.cmpnet.com/ads/graphics/cs/ps/Symantec%20Tile1_125x125.gif" border=1 height=125 width=125 alt="Click Here to visit Symantec"></a>
</td></tr>
</table>

<!-- End leftTOC.html -->

<!-- /LEFT COL NAV -->
</td>
<td width="7"><img src="http://img.cmpnet.com/cmpnet/blank.gif" width="7" height="1" border="0"></td>
</tr></table>





 
<table cellpadding=0 cellspacing=0 border=0 width=466>
<tr><td valign=top>

<font size="2" face="arial, helvetica">
<img src="http://img.cmpnet.com/custom/contentsecurity/blank.gif" width="325" height="1"><br>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="3"><img src="http://img.cmpnet.com/custom/contentsecurity/banner_11.jpg"></td>
<tr><td valign="top"><img src="http://img.cmpnet.com/custom/contentsecurity/blank.gif" width="292" height="1">

<font size="+1">The Trouble With Multivendor IPsec</font><br>
<i>Mike Fratto</i><br>

<a href="http://www.networkcomputing.com">Network Computing</a>

<br>

<br>
Supporting remote users over different connectivity strategies-cable, DSL or modems-or from a LAN-attached network becomes more complicated and more necessary every day. It's the need to secure communications to end users regardless of their location that makes remote access so complex. VPNs solve this problem to a large extent, but not without some headaches.<p>
More important, in the world of outsourced and temporary workers, consultants and fleeting trading partners-all of whom may be geographically dispersed-the need to secure communications over public networks becomes mission-critical. In a single vendor environment, VPN solutions connect users easily and securely from the remote desktop to the local network. But in most cases, you can't dictate specific software packages for use by external organizations.<p>
Unlike LAN-to-LAN VPNs, an IPsec (IP security) VPN is particularly onerous (for more on IPsec interoperation, see "Making IPsec Work for You," at www.networkcomputing.com/ 922/922ws2.html). Although the core IPsec protocols are standardized, widely supported and interoperable, problems with remote-access support, such as remote-user authentication and client configuration, make client IPsec VPN interoperability difficult to implement and support.<p>
A new IETF working group, IPSRA (IPsec Remote Access), is addressing secure remote access. The group is working on several drafts focused on client network configuration and authentication. These protocol drafts (which can be found at www.ietf.org/html. charters/ipsec-charter.html) are still in the early stages, with some interoperability work being done. Certain products, including Cisco Systems' IOS, IRE's SafeNet line and Newbridge Networks Corp.'s 130 Secure VPN Client (formerly TimeStep Permit/Client), are shipping with these new protocols, but we expect wider adoption next quarter and throughout the year. And the IETF isn't forging ahead alone. Microsoft Corp. is in the fray with Windows 2000 and L2TP (Layer 2 Tunneling Protocol) secured by IPsec.<p>
Although IPsec products can use certificates during negotiation, a number of interoperability issues limit certificate use to single-vendor environments. Multivendor situations call for preshared IKE, which uses a secret, or password, to mutually authenticate IPsec devices. Because preshared secrets need to be distributed and managed, this solution isn't as secure or scalable as certificates, but preshared secret IKE is a viable alternative for limited-size implementations.<p>
For this workshop, we used shipping products-including Cisco's 4700 with IOS 12.0(2a)T1, Newbridge's 234 Secure VPN Gateway (formerly TimeStep Permit/Gate 4520), IRE's SoftPK 2.1.0 (Build 15) and F-Secure Corp.'s VPN+-to see just what interoperable IPSec means and what you need to make it happen.<p>
Setting the Policy<p>
Using an IPsec VPN solution from a single vendor has many advantages: Vendors can support more options in a proprietary fashion than are currently supported as standards. Client network configuration, remote-user authentication and data compression all are implemented in numerous solutions. But these advantages disappear in a multivendor environment. IPsec vendors recognize the need to interoperate and support the standards, but they also need to meet customer demands. So just forget about automatic configuration for the moment. It may be possible to create and distribute profiles to your end users, but doing so is vendor-dependent. As we all know, manual configuration doesn't scale beyond a handful of users.<p>
Setting up client IPsec VPN is similar to setting up a LAN-to-LAN VPN. Security and networking parameters must match on both ends. We created a very simple network with a Newbridge 130 Secure VPN Client and a SoftPK client, both of which talked to the Cisco router and 234 Secure VPN Gateway (see "Network Map" on page 98). Our security policy was simple: All connections passing from the public network to the private network were to be secured with ESP (Encapsulating Security Payload) using 3DES encryption and MD5 authentication. Setting up the Cisco router and Newbridge 130 Secure VPN Client/234 Secure VPN was a snap. The only problem was that each peer name and shared secret, which function as a user name/password for each individual client, had to be entered manually. Currently, the only supported peer name in interoperable preshared secret VPN devices is the host IP address, and knowledge of the corresponding shared secret ensures authentication.<p>
Once our VPN gateways were properly configured, we set up the clients. Although manually configuring IPsec isn't difficult for users familiar with IPsec and networking, those unfamiliar with the underpinnings of IPsec will need more support. The goal is to match the security proposals and network addresses for both IKE and IPsec with the accepted VPN gateway proposals. Typically you need only one security policy definition on the client that contains all the acceptable security configurations. For example, a remote user may need to use 3DES with HMAC-MD5 when forming a VPN with the corporate network, but a trading partner requires DES with HMAC-MD5. When the client negotiates the VPN, it will send both proposals to the remote IPsec device. The remote IPsec device will typically select the first proposal it finds acceptable-so order is important. Once the security profile is defined, the destination network and gateway must be defined.<p>
Configuration may become confusing when it comes to IP addressing. IP addresses are used to identify the SA (Security Association) to which an incoming packet belongs. An ID or destination address can be a host address or a subnet address. If the addresses of the two IPsec devices do not match correctly, the IPsec phase two negotiation may fail. The IPsec client will use the desktop's IP address as its identity by default, but the remote destination address must be configured manually. Vendors are flexible in their ID syntax implementations, so make sure your specific products let you dictate your syntax. In some IPsec VPN gateways, 10.1.1.1/24 may not equal 10.1.1.1/255.255.255.0, even though logically these statements seem equivalent, because the latter uses a fully qualified IP address/ subnet mask pair while the former uses shorthand. Using identical IP address/subnet mask pairs in the IPsec VPN is always best.<p>
Remote Configuration<p>
Client VPN is similar to traditional remote access, wherein remote users need a local presence (IP address, routing, local DNS, WINS) on the remote network to access internal resources and maintain security. Because no standard methods are employed, client configuration options, such as IP address, DNS and WINS, fall by the wayside when using client IPsec in a multivendor environment. Some drafts in the IPsec working group (the drafts will be moved to the IPSRA group) are aimed at solving the remote-configuration problem. Altiga Networks, VPNet and others have solved the problem with proprietary methods, but that won't help in multivendor situations.<p>
The ISAKMP Configuration Method uses a separate transaction exchange within phase one IKE that can set basic addressing information in the client prior to phase two negotiation. Next, the phase two exchange takes place setting up the IPsec VPN using the information from the phase one transaction exchange. Initiated from either end, the ISAKMP Configuration Method is used with a request/reply or set/acknowledge message pair. For example, when a remote user connects to a VPN gateway with IPsec, the first step is to create a phase one SA, which is used to secure further IPsec negotiations. The transaction exchange is secured by the phase one SA.<p>
Although the ISAKMP Configuration Method is lightweight in terms of message exchange, it offers limited configuration options. If the client needs more information, it can send a DHCPINFORM message after the phase two SA is up. This makes the security association cleaner, because the security mechanisms in IPsec are being used to secure traffic rather than sending initial IP traffic from anywhere to anywhere (DHCP broadcast). Of course, this draft does not address initiating a DHCPINFORM message after the connection is made. In that case, it must be initiated by the client.<p>
DHCP Configuration of IPsec Tunnel Mode tries to solve the client configuration problem by creating a short-lived, separate phase two connection for DHCP configuration. Once the DHCP negotiation is completed, the DHCP SA is torn down, and the client phase two SA is built. Further DHCP messages can be carried within this SA. The main benefit is that DHCP is well-known and widely implemented, but there are problems with this approach.<p>
IPsec is designed to match network connections between source and destination address with specific security parameters, such as encryption and authentication. It is perfectly reasonable to specify different encryption levels for traffic bound to different destinations. DHCP broadcasts are network connections to anywhere (0.0.0.0; see "Securing Network Connections," at left), and without special handling, the VPN devices have no way to secure the connection. In order for an IPsec device to handle initial DHCP requests, a special, short-lived SA to nowhere must be created: The DHCP messages are relayed, the connections are torn down, and a second SA for all subsequent traffic is created. While technically feasible, the destination address should be something other than "anywhere."<p>
Even though the ISAKMP Configuration Method and DHCP Configuration are relatively young, vendors are deploying them, so make sure your IPsec client isn't configured for any special options, such as requesting a network address or offering any authentication beyond IKE. These seemingly innocuous options will cause the connection to fail, because one side or the other won't complete negotiation. During testing, we inadvertently configured our Newbridge 130 Secure VPN Client to implement virtual tunneling, which is Newbridge's implementation of the ISAKMP Configuration Method used to negotiate an IP address from the remote network. What we got was an IKE failure with our Cisco router, which didn't understand the ISAKMP Configuration Method.<p>
Authentication<p>
Solving the remote-user authentication problem has been tough. IPsec devices authenticate bidirectionally using either certificates or preshared secrets. In the phase one negotiation, both peers authenticate each other. In a remote-access environment, this poses two problems: You must either set up a PKI and issue certificates (a time-consuming and expensive proposition) or distribute passwords (or preshared secrets) to end users. What you really want is to authenticate the user trying to access the network and employ existing user databases. IKE doesn't support authentication, such as user name/ password, but ISAKMP is extensible.<p>
Extended Authentication Within ISAKMP/Oakley (XAUTH) lets you authenticate users via legacy methods after a phase one negotiation is complete. XAUTH is a one-way authentication method. Once the XAUTH negotiation is complete, IPsec processing progresses to phase two. However, XAUTH doesn't completely solve the remote-user authentication problem because the remote user's IP address must be known prior to negotiating IKE. A Hybrid Authentication Mode for IKE defines a method for using two unidirectional authentication methods to complete a mutually authenticated session. Hybrid should be used when the client's IP address is not known a priori or end users don't have digital certificates. Hybrid uses phase one IKE to authenticate the VPN gateway to the remote client. Once phase one is complete, the VPN gateway initiates a transaction exchange (using XAUTH) to authenticate the user. If that is successful, the IKE SA is mutually authenticated and proceeds to phase two.<p>
Send your comments on this article to Mike Fratto at mfratto@nwc.com.<p>
--<p>
IPsec Speak <p>
If you're an IPsec VPN newbie, you'll quickly find yourself immersed in a plethora of unique terms and acronyms. This brief glossary can get you started and help you through the main article.<p>
- Identity: This can mean many things, but in this article, where we discuss preshared secret IKE, identities are IP addresses, either host or subnet.<p>
- Internet Key Exchange (IKE): A secure protocol used to exchange and manage cryptographic keys. IKE can use preshared keys or X.509 certificates.<p>
- Phase one (also called main mode): Refers to an initial SA (Security Association) built between two IPsec endpoints. Phase one SAs establish the security parameters for key management for its SA and for subsequent SAs.<p>
- Phase two (also called quick mode): Phase two is secured by phase one and establishes the security parameters for the IPsec SAs. Phase two SAs are protected by phase one.<p>
- Preshared keys: Analogous to passwords, preshared keys authenticate IPsec end points. Each IPsec end point in a VPN must have identical preshared keys. Preshared keys are exchanged out-of-band through secure e-mail or on hard media.<p>
- Proposal: An IPsec device negotiates security via proposals. A proposal states the security parameters, such as encryption algorithm, integrity algorithm or key lifetime. IPsec devices can support multiple security configurations and will send multiple proposals.<p>
- Security Association (SA): Provides security services for the traffic it carries, such as encryption, data integrity and key management.<p>
http://www.nwc.com/<p>
Copyright ® 2000 CMP Media Inc.<p>

</td>
 <td><img src="http://img.cmpnet.com/custom/contentsecurity/blank.gif" width="40" height="2"></td>
 <td valign="top" width="100" bgcolor="#ffffcc">
<img src="http://img.cmpnet.com/custom/contentsecurity/blank.gif" width="136" height="1"><br>


<img src="http://img.cmpnet.com/custom/contentsecurity/right_stories.gif"><br>
<table cellpadding="8" cellspacing="0" border="0" width="136">
<tr><td>
<table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr><td><font size="1" face="arial, helvetica"><a href="74.html"><b>Lax Corporate Policies -- Security Shortchanged</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="25.html"><b>Task Force: Internet Security Holes Rampant</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="34.html"><b>Healthy Forecast For Firewall Market</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="35.html"><b>ATM, Frame Relay Data Networks Insecure</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="36.html"><b>Breach Protection</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="21.html"><b>Denial-Of-Service Program Expands To PCs</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="9.html"><b>Get a Grip on Handheld Security</b></a></font></td></tr><tr><td><font size="1" face="arial, helvetica"><a href="4.html"><b>StarMedia Chief Says Content Is Not King</b></a></font></td></tr>
</td></tr></table>
</td></tr>
</table>

</td>
</tr></table>

<br>

<br>
<table width="470" border=0 cellspacing=0 cellpadding=0>

<tr>


<td><img src="http://img.cmpnet.com/custom/contentsecurity/blank.gif" align="left"  width="182" border=0 height="1" hspace="0" vspace="0" alt="blank"></td>
<td align="right"><a href="http://enterprisesecurity.symantec.com/jp/symesjp1.cfm?jid=3"><img src="http://img.cmpnet.com/custom/contentsecurity/nav_symantec.jpg" width="160" height="31" border=0 hspace="0" vspace="0" alt="symantecimage"></a></td>


</tr>
</table>

<p>
<!-- -------- FOOTER BEGIN ----------->
<center>
<a target="_top" href="http://newads.cmpnet.com/event.ng/Type=click&ProfileID=462&RunID=3855&AdID=1944&GroupID=9&FamilyID=1&TagValues=163.179&Redirect=http:%2F%2Fwww.cmpnet.com"><img src="http://img.cmpnet.com/ads/graphics/cs/cg/heyyou.gif" border=1 height=60 width=468 alt="Click Here to Vist CMPNET"></a>
<table border=0 cellspacing=0 cellpadding=0>
<tr>
	
	<td align=center> <font size="2" face="Geneva,Arial,helvetica"> <br clear=all> <br clear=all>
<font size="-2"><a href="../index.html" class="black"><font color="black">Home</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;<a href="../section/14.html" class="black">
<font color="black">CMP News</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;
<a href="../section/11.html" class="black"><font color="black">CMP Features</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;
<a href="../category/7.html" class="black"><font color="black">Vulnerability
Assessment</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;<a href="../category/1.html"
class="black"><font color="black">Mobile Code Protection</font></a><br> <a href="../category/4.html" class="black"><font color="black">Email Content Filtering</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;<a href="../category/3.html" class="black"><font color="black">Internet Content Filtering</font></a>&nbsp;&nbsp;/&nbsp;&nbsp;<a href="../category/5.html" class="black"><font color="black">Virus Protection</font></a></font>
	</td>
</tr>
</table>
<center>
<!-- -------- FOOTER END --------- -->
<br>
<br>

</td>
</tr>
</table>
</BODY>
</HTML>






