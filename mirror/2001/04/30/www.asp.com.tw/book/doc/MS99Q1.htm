<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=big5">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>第 五 篇</TITLE>
<META NAME="Template" CONTENT="F:\CWORD60\TEMPLATE\manual1.dot">
</HEAD>
<BODY LINK="#0000ff">

<FONT SIZE=7><P ALIGN="CENTER">SQL Server 7.0</P>
<P ALIGN="CENTER">Web</FONT><FONT FACE="全真中隸書,細明體" LANG="ZH-TW" SIZE=7>資料搜尋技巧</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff"><P ALIGN="RIGHT">刊登於微軟之友</FONT><FONT SIZE=4 COLOR="#0000ff">1999</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff">年春季號</FONT><FONT SIZE=4 COLOR="#0000ff">                             </FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff">作者</FONT><FONT SIZE=4 COLOR="#0000ff"> </FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff">喬篷科技</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff"> </FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4 COLOR="#0000ff">周世雄</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>本文重點</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">在前幾期的</FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>專欄當中，我們看到了<A NAME="_Toc416339365"></FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫</A></FONT><FONT FACE="超研澤中隸,新細明體" LANG="ZH-TW" SIZE=3>設計速成</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、和微軟多層式</FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>架構等單元。本期將探討網站資料搜尋技巧，包括</FONT><FONT SIZE=3>SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫的中文全文檢索技巧。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW"><P ALIGN="JUSTIFY"></P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">筆者為微軟台北廳、經銷商訓練、</FONT><FONT SIZE=3>TechNet</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>等研討會講師，和微軟之友、</FONT><FONT SIZE=3>RUN!PC</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>雜誌專欄作者，著作有「</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>網站熱門應用技術</FONT><FONT FACE="標楷體" LANG="ZH-TW">」</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、「微軟熱門Web技術速成班」、「</FONT><FONT SIZE=3>IIS 4.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>超級網站速成班」等網站網頁設計十幾本電腦書籍。現任「喬篷科技」公司總經理，從事『網站熱門應用精選』軟體、</FONT><FONT SIZE=3>Internet</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>Intranet</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>之</FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫應用設計、網站網頁規劃架設等服務。</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫示範網站</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW">：</FONT>www.asp.com.tw</P>
<FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">連絡</FONT><FONT SIZE=3>E-mail</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>：</FONT><FONT SIZE=3>jackchou@tpts5.seed.net.tw</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>網站如何加入資料搜尋的功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">如何於您的網站加入中文全文檢索的資料搜尋功能呢？</P>
<P ALIGN="JUSTIFY">資料搜尋包括對檔案裡資料做搜尋的「檔案資料」搜尋、以及對</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>裡資料做搜尋的「</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料」搜尋兩種方式，解決方案如下</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW">：</P>
<OL>

</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY"><LI>「檔案資料」搜尋</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW">：</FONT><FONT SIZE=3>Microsoft Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</LI></P>
<P ALIGN="JUSTIFY"><LI>「</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料」搜尋</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW">：</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>使用</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令的</FONT><FONT SIZE=3>LIKE</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>語法、或</FONT><FONT SIZE=3>Microsoft SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的中文全文檢索（</FONT><FONT SIZE=3>Full Text Search</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>）功能。</LI></P></OL>

</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>Microsoft Index Server</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">於</FONT><FONT SIZE=3>Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>當中所包括的</FONT><FONT SIZE=3>Microsoft Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，提供中文全文檢索的搜尋功能，可以搜尋網站中</FONT><FONT SIZE=3>Microsoft Word </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>或</FONT><FONT SIZE=3>Microsoft Excel</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>檔案、</FONT><FONT SIZE=3>text</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>html</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>等檔案格式內的資料。</P>
</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>SQL</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">指令</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">LIKE</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">搜尋</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">一般資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>搜尋</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，可以使用</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令的</FONT><FONT SIZE=3>LIKE</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>語法，如下：</P><DIR>

</FONT><FONT FACE="Arial" SIZE=3><P>select * from </FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表名稱</FONT><FONT FACE="Arial" SIZE=3> where </FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>欄位</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>名稱</FONT><FONT FACE="Arial" SIZE=3> LIKE '%</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>搜尋的字串</FONT><FONT FACE="Arial" SIZE=3>%’</P></DIR>

</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">譬如：「</FONT><FONT SIZE=3>select * from </FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>客戶</FONT><FONT SIZE=3> where </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>地址</FONT><FONT SIZE=3> LIKE '%</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>台北市</FONT><FONT SIZE=3>%’</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>」可以搜尋到</FONT><U><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>客戶</U>資料表當中</FONT><U><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>地址</U>欄位有包含<U>台北市</U>的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
<P ALIGN="JUSTIFY">使用</FONT><FONT SIZE=3>LIKE</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>語法</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>的最大缺點</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，為動作太慢，因為必須對</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>裡的資料一筆一筆地做搜</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>尋</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。另外，雖然</FONT><FONT SIZE=3>Access</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫的</FONT><FONT SIZE=3>Memo</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>類型欄位資料也可以搜</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>尋得到</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，但是無法搜</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>尋</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>某些類型的欄位資料，譬如</FONT><FONT SIZE=3>SQL Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3>Text</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>類型的欄位資料無法使用</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令</FONT><FONT SIZE=3>LIKE</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>語法做搜</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>尋</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>SQL Server 7.0</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">全文檢索</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">對</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料庫</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的資料做</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>搜尋</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，最好的方式為使用</FONT><FONT SIZE=3>Microsoft SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3>Full Text Search</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>功能，可以對</FONT><FONT SIZE=3>Char</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>Varchar</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>Text</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>NText</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>NChar</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>NVarchar</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>類型欄位的資料做中文全文檢索的搜尋功能。</P>
<P ALIGN="JUSTIFY">您必須安裝</FONT><FONT SIZE=3>Microsoft SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3>Full Text Search</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>部份，這部份並未包括於</FONT><FONT SIZE=3>SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的一般安裝步驟當中，必須另外安裝，才可以使用中文全文檢索的搜尋功能。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>設定待搜查資料表的步驟</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">首先要設定待搜查的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，方法為執行</FONT><FONT SIZE=3> [SQL Server Enterprise Manager]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，於待搜查的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表譬</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>如</FONT><FONT SIZE=3> [Northwind] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫的</FONT><FONT SIZE=3> [Customers] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料表上按右鍵，選擇</FONT><FONT SIZE=3> [Full-Text Index Table] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3> [Define Full-Text Indexing on a Table]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。即會顯示</FONT><FONT SIZE=3> [Full-Text Indexing Wizard] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的畫面。按下</FONT><FONT SIZE=3> [</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>下一步</FONT><FONT SIZE=3>]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，選擇做為唯一索引的欄位。按下</FONT><FONT SIZE=3> [</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>下一步</FONT><FONT SIZE=3>]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，選擇做為唯一索引的欄位。按下</FONT><FONT SIZE=3> [</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>下一步</FONT><FONT SIZE=3>]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，選擇或新產生一個儲存索引資料的</FONT><FONT SIZE=3>catalog</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
<P ALIGN="JUSTIFY">接著按下</FONT><FONT SIZE=3> [New Schedule] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>按鈕排定索引行程，設定多久做一次索引，</FONT><FONT SIZE=3>[Job type] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>可選擇</FONT><FONT SIZE=3> [Full] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>或</FONT><FONT SIZE=3> [Incremental]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，</FONT><FONT SIZE=3>[Full] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>表示對整個資料表的資料重新做索引，</FONT><FONT SIZE=3>[Incremental] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>表示僅對資料表異動的資料做索引，譬如排定每天半夜對資料表異動的資料做一次索引。按下</FONT><FONT SIZE=3> [OK] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>和</FONT><FONT SIZE=3> [</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>下一步</FONT><FONT SIZE=3>]</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，即定義好設定待搜查的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
<P ALIGN="JUSTIFY">這時候並未對待搜查的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表做</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>索引，必須於</FONT><FONT SIZE=3>[Full-Text Catalogs] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>中所設定的</FONT><FONT SIZE=3>catalog </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>如</FONT><FONT SIZE=3> [</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>客戶</FONT><FONT SIZE=3>] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>按右鍵選擇</FONT><FONT SIZE=3> [Start Population] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3> [Full Population] </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>對整個資料表的資料重新做索引。</P>
<P ALIGN="JUSTIFY">以上設定將於每天半夜對資料表異動的資料做一次索引。資料表的資料有異動時，因為並未立即做索引，必須於隔天半夜做一次索引後，才可以搜尋到異動的資料。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>透過網際網路搜尋資料庫的資料</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">如何透過網際網路或</FONT><FONT SIZE=3>intranet</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，搜尋伺服器資料庫的資料呢？在</FONT><FONT SIZE=3>Windows NT</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的平台上，最好的選擇就是使用</FONT><FONT SIZE=3>IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>（</FONT><FONT SIZE=3>Internet Information Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>）的網站伺服器，採得</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>（</FONT><FONT SIZE=3>Active Server Pages</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>）撰寫程式。</P>
<P ALIGN="JUSTIFY">讓我們先來看看</FONT><FONT SIZE=3>Microsoft SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的中文全文檢索（</FONT><FONT SIZE=3>Full Text Search</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>）範例</FONT><FONT SIZE=3>ft1.asp</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的執行結果，於用戶端使用瀏覽器，瀏覽執行</FONT><FONT SIZE=3>ft1.asp</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的結果，顯示搜尋到資料的記錄。</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的中文全文檢索十分簡易，只要於</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令使用</FONT><FONT SIZE=3>CONTAINS</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的語法，如下：</P><DIR>

</FONT><FONT FACE="Arial" SIZE=3><P>select * from </FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料表名稱</FONT><FONT FACE="Arial" SIZE=3> where CONTAINS( </FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>欄位</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>名稱, </FONT><FONT FACE="Arial" SIZE=3>'</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>搜尋的條件</FONT><FONT FACE="Arial" SIZE=3>’)</P></DIR>

</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">譬如：「</FONT><FONT SIZE=3>SELECT * FROM Customers where CONTAINS(Address,'</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>台北市</FONT><FONT SIZE=3>')</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>」可以搜尋到</FONT><U><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>客戶</U>資料表當中</FONT><U><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>地址</U>欄位有包含<U>台北市</U>的</FONT><FONT FACE="華康少女文字體W4,細明體" LANG="ZH-TW" SIZE=3>資料</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>程式範例</FONT><FONT SIZE=3>ft1.asp</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，如下：</P>
</FONT><FONT SIZE=3><P>&lt;%</P>
<P>Set cn = Server.CreateObject("ADODB.Connection")</P>
<P>'cn.Provider = "sqloledb"</P>
<P>'cn.Open "server=(Local);uid=sa;pwd=;database=Northwind"</P>

<P>cn.Open "driver={SQL Server};server=(Local);uid=sa;pwd=;database=Northwind"</P>

<P>Set rs = Server.CreateObject("ADODB.Recordset")</P>
<P>SqlStr = "SELECT * FROM Customers where CONTAINS(Address,'</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>台北市</FONT><FONT SIZE=3>')" </P>
<P>rs.Open SqlStr,cn,1,1</P>

<P>%&gt;&lt;BR&gt;</P>

<P>&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;</P>
<P>&lt;TR&gt;</P>
<P>&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;&lt;FONT COLOR="#FFFFFF"&gt;</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>公司</FONT><FONT SIZE=3>&lt;/FONT&gt;&lt;/TD&gt;</P>
<P>&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;&lt;FONT COLOR="#FFFFFF"&gt;</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>電話</FONT><FONT SIZE=3>&lt;/FONT&gt;&lt;/TD&gt;</P>
<P>&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;&lt;FONT COLOR="#FFFFFF"&gt;</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>地址</FONT><FONT SIZE=3>&lt;/FONT&gt;&lt;/TD&gt;</P>

<P>&lt;% Do while not rs.EOF %&gt;</P>
<P>&lt;TR&gt;</P>

<P>&lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;&lt;%= rs("CompanyName") %&gt;&lt;/TD&gt;</P>
<P>&lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;&lt;%= rs("Phone") %&gt;&lt;/TD&gt;</P>
<P>&lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;&lt;%= rs("Address") %&gt;&lt;/TD&gt;</P>

<P>&lt;/TR&gt;  </P>

<P>&lt;% </P>
<P>rs.MoveNext</P>
<P>Loop </P>
<P>rs.Close</P>
<P>Set cn = Nothing</P>
<P>%&gt;</P>
<P>&lt;/TABLE&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">以上範例的說明，首先於</FONT><FONT SIZE=3>asp</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>程式設定連結到資料庫，連結到</FONT><FONT SIZE=3>SQL Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫的</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>程式如下：</P>
</FONT><FONT FACE="Arial" SIZE=3><P>cn.Open "Driver={SQL Server};Database=</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>資料庫名稱</FONT><FONT FACE="Arial" SIZE=3>;Server=</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>（</FONT><FONT FACE="Arial" SIZE=3>Local</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>）</FONT><FONT FACE="Arial" SIZE=3>; </P>
<P>UID=sa; PWD=”</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">設定了資料庫連結後，第二個步驟就是要下</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令，將</FONT><FONT SIZE=3>SQL</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>指令查詢的結果儲存到</FONT><FONT SIZE=3>Recordset</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>物件</FONT><FONT SIZE=3>rs</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>當中，由</FONT><FONT SIZE=3>rs(“</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>欄位</FONT><FONT SIZE=3>”) </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>讀取資料庫欄位的資料，</FONT><FONT SIZE=3>rs.MoveNext</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>移動到下一筆記錄，經由</FONT><FONT SIZE=3>rs.EOF</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>判斷是否已經到最末筆，配合</FONT><FONT SIZE=3>Do while…Loop</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>就可以取得查詢結果的所有記錄。</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>除了提供</FONT><FONT SIZE=3>ODBC</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>驅動程式外，也提供了</FONT><FONT SIZE=3>OLE DB Provider</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>，</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>如何透過</FONT><FONT SIZE=3>OLE DB</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>存取</FONT><FONT SIZE=3>SQL Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>呢？</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>程透過</FONT><FONT SIZE=3>OLE DB </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>與</FONT><FONT SIZE=3>ODBC</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>驅動程式存取</FONT><FONT SIZE=3>SQL Server </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的差異處，為</FONT><FONT SIZE=3>OLE DB </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>須指定</FONT><FONT SIZE=3>Provider</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>是誰，即只要多加一行「</FONT><FONT SIZE=3>cn.Provider = "sqloledb"</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>」程式就可以了，其他與</FONT><FONT SIZE=3>ODBC</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>驅動程式存取</FONT><FONT SIZE=3>SQL Server </FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的方法相同。連結到</FONT><FONT SIZE=3>SQL Server</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫的</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>程式如下：</P>
</FONT><FONT FACE="Arial" SIZE=3><P>cn.Provider = "sqloledb"</P>
<P>cn.Open "server=(Local);uid=sa;pwd=;database=</FONT><FONT FACE="華康中楷體,細明體" LANG="ZH-TW" SIZE=3>資料庫名稱</FONT><FONT FACE="Arial" SIZE=3>"</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">搜尋的條件可以使用</FONT><FONT SIZE=3>AND</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>OR</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>NEAR</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>等關鍵字。另外除了</FONT><FONT SIZE=3>CONTAINS</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>外，也可以使用</FONT><FONT SIZE=3>FREETEXT</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的語法。詳細語法請參考</FONT><FONT SIZE=3>SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的</FONT><FONT SIZE=3>Books Online</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>。</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>的中文全文檢索使用方法是不是十分簡易呢？</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>網站資料庫設計參考資料</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">作者準備一個展示各種</FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫設計實例的網站，提供各種網站網頁的資訊、與設計範例，包括</FONT><FONT SIZE=3>IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>特異功能、</FONT><FONT SIZE=3>Web</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>資料庫設計實例、網路商店、</FONT><FONT SIZE=3>ActiveX</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、推播頻道、動態</FONT><FONT SIZE=3>HTML</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>、</FONT><FONT SIZE=3>HTML 99</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>招等，網址如下：</P>
<P ALIGN="JUSTIFY"></FONT><A HREF="../../index.html"><FONT SIZE=3>http://www.asp.com.tw</FONT></A></P>
<FONT FACE="新細明體" LANG="ZH-TW" SIZE=3><P ALIGN="JUSTIFY">歡迎上網光臨指教。</P>
<P ALIGN="JUSTIFY">另外筆者最新著作為「微軟熱門Web技術速成班」（松崗出版）、「</FONT><FONT SIZE=3>ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>網站熱門應用技術</FONT><FONT FACE="標楷體" LANG="ZH-TW">」</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>（</FONT><FONT SIZE=3>Microsoft Press/</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>華彩出版），對</FONT><FONT SIZE=3>SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW" SIZE=3>網站資料庫的技術提供更多的探討，歡迎參考。</P></FONT></BODY>
</HTML>
