<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=big5">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>第 五 篇</TITLE>
</HEAD>
<BODY LINK="#0000ff" VLINK="#800080">

<FONT FACE="System,新細明體" LANG="ZH-TW" SIZE=7><P ALIGN="CENTER">5</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=7>個實用網站功能速成</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4><P ALIGN="RIGHT">刊登於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW" SIZE=4>RUN!PC 1999/2</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4>月號</P>
<P ALIGN="RIGHT">作者</FONT><FONT SIZE=4> </FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4>喬篷科技</FONT><FONT FACE="華康少女文字體W4,???" LANG="ZH-TW" SIZE=4> </FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=4>周世雄</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5><P>本文重點</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">在前幾期的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS 4.0</FONT><FONT FACE="新細明體" LANG="ZH-TW">專欄當中，我們看到了威力強大的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Internet Information Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">4.0</FONT><FONT FACE="新細明體" LANG="ZH-TW">之</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">30</FONT><FONT FACE="新細明體" LANG="ZH-TW">個特異功能、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">與數位認證、如何使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">設計一個生動的網站、如何將</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW">資料庫化、</FONT><FONT FACE="華康少女文字體W4,???" LANG="ZH-TW">IIS 4.0</FONT><FONT FACE="超研澤中隸,????" LANG="ZH-TW">網站進階管理</FONT><FONT FACE="新細明體" LANG="ZH-TW">、如何將網站元件化、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">三層式架構技術速成、和</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SQL Server 7.0</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站資料庫的技術等單元。本期將探討</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">5</FONT><FONT FACE="新細明體" LANG="ZH-TW">個實用的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站功能。</P>
<P ALIGN="JUSTIFY">筆者為微軟台北廳、經銷商訓練、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">TechNet</FONT><FONT FACE="新細明體" LANG="ZH-TW">等研討會講師，和微軟之友、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">RUN!PC</FONT><FONT FACE="新細明體" LANG="ZH-TW">雜誌專欄作者，著作有「</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站熱門應用技術</FONT><FONT FACE="標楷體" LANG="ZH-TW">」</FONT><FONT FACE="新細明體" LANG="ZH-TW">、「微軟熱門Web技術速成班」等網站網頁設計十幾本電腦書籍。現任「喬篷科技」公司總經理，從事</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Internet</FONT><FONT FACE="新細明體" LANG="ZH-TW">、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Intranet</FONT><FONT FACE="新細明體" LANG="ZH-TW">之</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW">資料庫應用設計、網站網頁規劃架設等服務。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">IIS 4.0</FONT><FONT FACE="新細明體" LANG="ZH-TW">示範網站</FONT><FONT FACE="華康少女文字體W4,???" LANG="ZH-TW">：</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">www.asp.com.tw</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">連絡</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">E-mail</FONT><FONT FACE="新細明體" LANG="ZH-TW">：</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">jackchou@tpts5.seed.net.tw</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5><P>　</P>
</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>5</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">個實用的</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">ASP</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">網站功能</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">前幾期學會了如何將網站</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">化、資料庫化、和元件化的「網站</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">3</FONT><FONT FACE="新細明體" LANG="ZH-TW">化」後，本期將教您如何善用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">5</FONT><FONT FACE="新細明體" LANG="ZH-TW">個實用的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站功能。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">5</FONT><FONT FACE="新細明體" LANG="ZH-TW">個實用的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站功能如下：</P>

<UL>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">功能：「同生共死」的異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">功能：安全傳輸。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">功能：非同步處理功能。</LI></P>
<P ALIGN="JUSTIFY"><LI>中文全文檢索功能。</LI></P>
<P ALIGN="JUSTIFY"><LI>郵件傳送功能。</LI></P></UL>

</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6><P>　</P>
</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000"><P>網站如何加入</FONT><FONT FACE="Arial" SIZE=6 COLOR="#ff0000">Transaction</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000">功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何於您的網站加入異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能呢？</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Internet Information Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）與</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MTS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Transaction Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）緊密整合，資料庫更動可以有「同生共死」的異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</P>
<P ALIGN="JUSTIFY">當</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式中所有的資料庫更動都成功時，才算成功；有一個資料庫的更動失敗時，已經更動的資料庫資料將自動恢復（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">rollback</FONT><FONT FACE="新細明體" LANG="ZH-TW">），這就是所謂的異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</P>
<P ALIGN="JUSTIFY">譬如從甲帳戶匯款到乙帳戶時，若乙帳戶的資料庫更動失敗時，已經更動甲帳戶的資料庫資料將自動恢復（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">rollback</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。數個資料庫的資料更動，不是「同生」，就是「共死」。</P>
<P ALIGN="JUSTIFY">並不是所有資料庫都提供異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）的功能，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Access</FONT><FONT FACE="新細明體" LANG="ZH-TW">沒有提供，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SQL Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">和</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Oracle</FONT><FONT FACE="新細明體" LANG="ZH-TW">則提供異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）的功能。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式中異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能的有效範圍為一個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式，換句話說，這個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式中所有的資料庫更動都具有異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</P>
<P ALIGN="JUSTIFY">如何於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式中告訴</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">要做異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能的處理呢？</P>
<P ALIGN="JUSTIFY">方法為於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式碼當中的第一行加入「</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">TRANSACTION=Required</FONT><FONT FACE="新細明體" LANG="ZH-TW">」，告訴</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">這一個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式使用異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能的處理方式，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%@ TRANSACTION=Required LANGUAGE="VBScript" %&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">若此</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式內所有程式（包括更新數個資料庫）執行成功時，將呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">OnTransactionCommit</FONT><FONT FACE="新細明體" LANG="ZH-TW">（）副程式。若執行失敗（包括更新任何一個資料庫失敗）時，將呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">OnTransactionAbort</FONT><FONT FACE="新細明體" LANG="ZH-TW">（）副程式。</P>
<P ALIGN="JUSTIFY">您可以呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SetComplete</FONT><FONT FACE="新細明體" LANG="ZH-TW">方法表示執行成功，或呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SetAbort</FONT><FONT FACE="新細明體" LANG="ZH-TW">方法表示執行失敗。</P>
<P ALIGN="JUSTIFY">譬如</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%@ TRANSACTION=Required LANGUAGE="VBScript" %&gt;</P>
<P>...</P>
<P>&lt;% Set obj1 = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"testobj.cls1"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> %&gt;</P>
<P>&lt;% = obj1.data3t</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">1,10</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> %&gt;</P>
<P>&lt;%</P>
<P>Sub OnTransactionCommit</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（）</P>
<P>&#9;</FONT><FONT FACE="Arial"> </FONT><FONT FACE="System,新細明體" LANG="ZH-TW">…</FONT><FONT FACE="Arial"> </P>
<P>end sub</P>
<P>Sub OnTransactionAbort</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（）</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P>…</P>
</FONT><FONT FACE="Arial"><P>end sub</P>
<P>%&gt;</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>設計有</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Transaction</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">功能的元件</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何設計有異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能的元件呢？</P>
<P ALIGN="JUSTIFY">方法為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ActiveX DLL</FONT><FONT FACE="新細明體" LANG="ZH-TW">中使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ObjectContext</FONT><FONT FACE="新細明體" LANG="ZH-TW">物件，譬如說於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Visual Basic </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ActiveX DLL</FONT><FONT FACE="新細明體" LANG="ZH-TW">定義如下：</P>
</FONT><FONT FACE="Arial"><P>Dim objContext As ObjectContext</P>
<P>Set objContext = GetObjectContext</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（）</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">執行成功時，呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SetComplete</FONT><FONT FACE="新細明體" LANG="ZH-TW">方法，執行失敗時呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SetAbort</FONT><FONT FACE="新細明體" LANG="ZH-TW">方法以釋放資源。</P>
<P ALIGN="JUSTIFY">譬如說於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Visual Basic </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ActiveX DLL</FONT><FONT FACE="新細明體" LANG="ZH-TW">，其</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Visual Basic</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式碼如下：</P>
</FONT><FONT FACE="Arial"><P>Function data3t</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">input1, points</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</P>
</FONT><FONT FACE="Arial"><P>On Error GoTo Error1</P>
<P>Dim objContext As ObjectContext</P>
<P>Set objContext = GetObjectContext</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（）</P>
</FONT><FONT FACE="Arial"><P>...</P>
<P>objContext.SetComplete</P>
<P>Exit Function</P>
<P>Error1:</P>
<P>objContext.SetAbort</P>
<P>End Function</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000"><P>網站如何加入</FONT><FONT FACE="Arial" SIZE=6 COLOR="#ff0000">SSL</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000">安全傳輸功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何於您的網站加入</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Secure Sockets Layer</FONT><FONT FACE="新細明體" LANG="ZH-TW">）安全傳輸功能呢？</P>
<P ALIGN="JUSTIFY">網路上的傳輸資料，都可能被攔截、竄改。首先我們先看看，如何將資料安全的傳輸呢？</P>
<P ALIGN="JUSTIFY">甚麼是對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法、公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Secure Sockets Layer</FONT><FONT FACE="新細明體" LANG="ZH-TW">）呢？</P>
<P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>對稱金鑰（</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Session Key</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">）法</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">最簡單的方法，為傳送者將待傳送的資料使用一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，傳送當中的資料為亂碼，不怕被人攔截，接收者收到資料後使用同一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）解密。</P>
<P ALIGN="JUSTIFY">所謂的金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）並不是真的是一把鑰匙，而是一個加解密的運算法則，譬如將每一個資料加</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">2</FONT><FONT FACE="新細明體" LANG="ZH-TW">，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">2</FONT><FONT FACE="新細明體" LANG="ZH-TW">即為一把金鑰。</P>
<P ALIGN="JUSTIFY">對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法的問題，為如何於網路上安全地交付這一把加解密的鑰匙？這一把鑰匙於網路上傳送交付，也可能被攔截、竄改。</P>
<P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>公開金鑰（</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Public Key</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">）法</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">於是，有人發明公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法，傳送者將待傳送的資料使用接收者的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，傳送當中的資料為亂碼，不怕被人攔截，接收者收到資料後使用另外一把接收者的的私密金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Private Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）解密。</P>
<P ALIGN="JUSTIFY">由於公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）不怕知道，因此適合於網路上安全地交付這一把加密用的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。</P>
<P ALIGN="JUSTIFY">由於對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法的運算較複雜，運算速度比對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法慢上數千倍。</P>
<P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>SSL</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">（</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Secure Sockets Layer</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">）</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Secure Sockets Layer</FONT><FONT FACE="新細明體" LANG="ZH-TW">），則融合對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法、和公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法的優點。</P>
<P ALIGN="JUSTIFY">瀏覽器會先產生一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">），將待傳送的資料使用這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，再使用接收者的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）將這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，傳送當中的資料為亂碼，接收者收到資料後使用另外一把接收者的私密金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Private Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）先將對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）解密，再使用這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）將傳送的資料解密。</P>
<P ALIGN="JUSTIFY">公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）法的問題，為如何確認這一把加密用接收者的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）的正確性？這一把接收者的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）於網路上傳送交付，也可能被攔截、竄改。</P>
<P ALIGN="JUSTIFY">因此必須有一個具備公信力的認證中心即所謂的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Authority</FONT><FONT FACE="新細明體" LANG="ZH-TW">），對接收者的即網站伺服器來核發一個伺服器認證，以證實這一把加密用接收者的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）確定為此伺服器所有。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Secure Sockets Layer</FONT><FONT FACE="新細明體" LANG="ZH-TW">），於網路上溝通的流程，如下：</P>
<OL>

<P ALIGN="JUSTIFY"><LI>首先瀏覽器發出</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">https:// </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">要求。</LI></P>
<P ALIGN="JUSTIFY"><LI>網站伺服器回應伺服器認證，包括伺服器的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）、認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">和其數位簽章、效期、序號、使用者，確定為此伺服器所有。</LI></P>
<P ALIGN="JUSTIFY"><LI>瀏覽器會先產生一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">），再使用伺服器的公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）將這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，伺服器收到後使用另外一把伺服器的私密金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Private Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）先解密出對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。</LI></P>
<P ALIGN="JUSTIFY"><LI>瀏覽器將待傳送的資料使用這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）加密，伺服器收到資料後，再使用這一把對稱金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Session Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）將傳送的資料解密。</LI></P></OL>

</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>Certificate Server</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">安裝</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，包括</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，提供認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">的功能。對伺服器核發伺服器認證，可以提供</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">安全傳輸的功能。</P>
<P ALIGN="JUSTIFY">若要安裝</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，執行</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">的安裝程式，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">新增</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">/</FONT><FONT FACE="新細明體" LANG="ZH-TW">移除</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">]</FONT><FONT FACE="新細明體" LANG="ZH-TW">，勾選</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Certificate Server]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">輸入資料庫和記錄的安裝路徑，和認證中心的描述，即可將</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Serve</FONT><FONT FACE="新細明體" LANG="ZH-TW">安裝好。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>申請伺服器認證</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">前面談到必須有一個具備公信力的認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">，對網站伺服器來核發一個伺服器認證，以證實公開金鑰（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Public Key</FONT><FONT FACE="新細明體" LANG="ZH-TW">）確定為此伺服器所有。</P>
<P ALIGN="JUSTIFY">您可以挑選具公信力的認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">，對網站伺服器來核發一個伺服器認證。也可以使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，自己成立一個認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">，就可以對伺服器核發伺服器認證，以提供</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">安全傳輸的功能。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>登記為「可信任」的</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">CA</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">安裝好</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">的伺服器認證後，第二個步驟，為於瀏覽器登記認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">為「可信任」的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">，執行</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">http://localhost/certsrv/ CertEnroll/cacerts.htm</FONT><FONT FACE="新細明體" LANG="ZH-TW">，按下</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Certificate for LISA\Actif CA]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">選擇開啟這個檔案，即可將</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">的認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">加到受信任發照者清單中，如。</P>
<P ALIGN="JUSTIFY">於瀏覽器的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Internet</FONT><FONT FACE="新細明體" LANG="ZH-TW">選項</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">內容</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">之</FONT> <FONT FACE="新細明體" LANG="ZH-TW">認證</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">機構</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">中，可以看到已經將</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Certificate Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">的認證中心</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">CA</FONT><FONT FACE="新細明體" LANG="ZH-TW">加到受信任機構清單中。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>使用</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">SSL</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">（</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Secure Sockets Layer</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">）</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">接著即可使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SSL</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Secure Sockets Layer</FONT><FONT FACE="新細明體" LANG="ZH-TW">）了，將瀏覽器傳送的資料加密，使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">https://</FONT><FONT FACE="新細明體" LANG="ZH-TW">執行。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式碼，如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;% If UCase(Request.ServerVariables("HTTPS")) = "ON" Then %&gt;</P>
<P>&lt;form action="ssl2.asp" method="GET"&gt;</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>使用者</FONT><FONT FACE="Arial">: &lt;INPUT TYPE=TEXT NAME=name1 VALUE=&lt;% =Request("name1") %&gt;&gt;&lt;br&gt;</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>密碼</FONT><FONT FACE="Arial">: &lt;INPUT TYPE=TEXT NAME=password1 VALUE=&lt;% =Request("password1") %&gt;&gt;</P>
<P>&lt;input type=submit VALUE="</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">寫完了</FONT><FONT FACE="Arial">"&gt;</P>
<P>&lt;/form&gt;</P>
<P>&lt;hr&gt;</P>
<P>&lt;% else %&gt;</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>須使用</FONT><FONT FACE="Arial">https://</P>
<P>&lt;% end if %&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">其中使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">UCase(Request.ServerVariables("HTTPS")) = "ON"</FONT><FONT FACE="新細明體" LANG="ZH-TW">檢查是否使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">https</FONT><FONT FACE="新細明體" LANG="ZH-TW">，若未使用則不允許輸入。</P>
<P ALIGN="JUSTIFY">　</P>
<P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000"><P>網站如何加入</FONT><FONT FACE="Arial" SIZE=6 COLOR="#ff0000">Message Queue</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000">功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何於您的網站加入</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的非同步處理功能呢？</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，包括</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Message Queue Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">），提供非「同步」處理的功能。</P>
<P ALIGN="JUSTIFY">網路可能緩慢不穩，資料庫也可能當機，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Message Queue Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）提供了非「同步」處理，可以降低同步的依賴。</P>
<P ALIGN="JUSTIFY">不懂？沒關係。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的關鍵為「連上線」（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">online</FONT><FONT FACE="新細明體" LANG="ZH-TW">）和「有空」（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">available</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。由於網路上所有的應用程式不一定都能同時</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">100%</FONT><FONT FACE="新細明體" LANG="ZH-TW">連上線（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">online</FONT><FONT FACE="新細明體" LANG="ZH-TW">），有的應用程式的電腦可能仍然開機。應用程式即使連上線，也可能沒有空（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">available</FONT><FONT FACE="新細明體" LANG="ZH-TW">）來處理與其他應用程式的連繫工作。</P>
<P ALIGN="JUSTIFY">所謂「同步」，譬如當網路上的甲應用程式想要傳送訊息到乙應用程式，必須等待乙應用程式的回應，才能繼續做下去時，這就是須要「同步」。</P>
<P ALIGN="JUSTIFY">但是，乙應用程式可能仍未連上線（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">online</FONT><FONT FACE="新細明體" LANG="ZH-TW">），也可能沒有空（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">available</FONT><FONT FACE="新細明體" LANG="ZH-TW">）來處理與甲應用程式的連繫工作。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Message Queue Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">），提供於分散環境下網路上多個應用程式的容錯功能。將不需要立刻回應的應用程式，以非同步方式來處理。</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">將甲應用程式的訊息儲存到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，等乙應用程式連上線也有空時，再來取得甲應用程式儲存於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的訊息。</P>
<P ALIGN="JUSTIFY">因此，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">支援行動運作（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mobile Computing</FONT><FONT FACE="新細明體" LANG="ZH-TW">），譬如筆記型電腦於正常狀況並無網路連線，待傳送的訊息可先存放在用戶端筆記型電腦的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，待爾後與網路連線，再上傳到伺服器端。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">與</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Internet Information Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）緊密整合，於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW">應用程式中使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">來控制</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">也與</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MTS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Transaction Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）緊密整合，傳送的訊息可以可以與資料庫的更動一起有「同生共死」的異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</P>
<P ALIGN="JUSTIFY">您可以使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式來開發</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW">應用程式，也可以使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Visual Basic</FONT><FONT FACE="新細明體" LANG="ZH-TW">或</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Visual C++</FONT><FONT FACE="新細明體" LANG="ZH-TW">等語言來開發</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的網路應用程式。</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>傳送</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Message</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">到</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">MSMQ</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何傳送</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">呢？</P>
<P ALIGN="JUSTIFY">若要執行</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">傳送</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的範例，首先安裝</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Message Queue Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，然後於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案總管</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">，新增加一個佇列（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">），名稱為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">test</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">方法為於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案總管</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的電腦上按右鍵，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">開新檔案</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">佇列</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">命名佇列名稱為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">test</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">於用戶端使用瀏覽器，瀏覽執行的結果。</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案總管</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">，於佇列</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">test</FONT><FONT FACE="新細明體" LANG="ZH-TW">的日誌下可以看到傳送到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">，顯示</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的主旨部份。</P>
<P ALIGN="JUSTIFY">於此</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">快速按兩下，可以於</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">本文</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">看到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的內文部份。</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式當中，如何傳送</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">呢？</P>
<P ALIGN="JUSTIFY">方法為首先使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Server.CreateObject</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"MSMQ.MSMQQueueInfo"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的元件，然後設定以下：</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">QueueInfo.pathname</FONT><FONT FACE="新細明體" LANG="ZH-TW">：設定</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">傳送的目的佇列（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">）的名稱。</P>
<P ALIGN="JUSTIFY">就可以使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">QueueInfo.Open</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">2, 0</FONT><FONT FACE="新細明體" LANG="ZH-TW">）開啟此佇列。</P>
<P ALIGN="JUSTIFY">接著</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Server.CreateObject</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"MSMQ.MSMQMessage"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">元件，然後設定以下</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的內文和主旨部份：</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">Msg.Label</FONT><FONT FACE="新細明體" LANG="ZH-TW">：設定</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的主旨部份。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">Msg.body</FONT><FONT FACE="新細明體" LANG="ZH-TW">：設定</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的內文部份。</P>
<P ALIGN="JUSTIFY">最後下個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Msg.Send Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">後，即開始傳送</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ </FONT><FONT FACE="新細明體" LANG="ZH-TW">的佇列下。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%</P>
<P>Set QueueInfo = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"MSMQ.MSMQQueueInfo"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</P>
</FONT><FONT FACE="Arial"><P>QueueInfo.pathname = ".\test</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">”</P>
</FONT><FONT FACE="Arial"><P>Set Queue = QueueInfo.Open</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">2, 0</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</P>
</FONT><FONT FACE="Arial"><P>Set Msg = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"MSMQ.MSMQMessage"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> </P>
<P>Msg.body = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">這是</FONT><FONT FACE="Arial">message body" &amp; now</P>
<P>Msg.Label = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">這是</FONT><FONT FACE="Arial">message label" &amp; now</P>
<P>Msg.Delivery = 1 </P>
<P>Msg.Send Queue </P>
<P>Queue.Close</P>
<P>%&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">將傳送</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">test</FONT><FONT FACE="新細明體" LANG="ZH-TW">佇列下。</FONT> </P>
<FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>從</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">MSMQ</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">接收</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Message</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何從</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">接收</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">呢？</P>
<P ALIGN="JUSTIFY">如果您急著從</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">接收剛剛傳送的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">，於用戶端使用瀏覽器執行，會遭到拒絕存取的訊息，這是因為未將使用權限設定為</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">完全控制</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的緣故。</P>
<P ALIGN="JUSTIFY">因此必須先修改設定。於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案總管</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">，於佇列</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">test</FONT><FONT FACE="新細明體" LANG="ZH-TW">上按右鍵，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">內容</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">]</FONT><FONT FACE="新細明體" LANG="ZH-TW">，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">安全設定</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">]</FONT><FONT FACE="新細明體" LANG="ZH-TW">，按下</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">使用權限</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">] </FONT><FONT FACE="新細明體" LANG="ZH-TW">按鈕，將</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Everyone]</FONT><FONT FACE="新細明體" LANG="ZH-TW">的存取類型設定為</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[</FONT><FONT FACE="新細明體" LANG="ZH-TW">完全控制</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">接著就可以從</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">接收剛剛傳送的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">，於用戶端使用瀏覽器執行。</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式當中，如何從</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">接收</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Messag</FONT><FONT FACE="新細明體" LANG="ZH-TW">呢？</P>
<P ALIGN="JUSTIFY">方法為首先使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Server.CreateObject</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"MSMQ.MSMQQueueInfo"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">的元件，然後設定</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">QueueInfo.pathname</FONT><FONT FACE="新細明體" LANG="ZH-TW">為待帶接收</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的佇列（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">）的名稱。</P>
<P ALIGN="JUSTIFY">就可以使用</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Set q = QueueInfo.Open</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">1,0</FONT><FONT FACE="新細明體" LANG="ZH-TW">）開啟此佇列。最後下個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">q.Receive</FONT><FONT FACE="新細明體" LANG="ZH-TW">後，即開始接收</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">。由</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Msg.Label </FONT><FONT FACE="新細明體" LANG="ZH-TW">、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Msg.Body</FONT><FONT FACE="新細明體" LANG="ZH-TW">可以讀到</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的內文和主旨部份。</P>
<P ALIGN="JUSTIFY">從</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Message Queue Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）接收</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%</P>
<P>Set QueueInfo = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"MSMQ.MSMQQueueInfo"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</P>
</FONT><FONT FACE="Arial"><P>QueueInfo.pathname = ".\test"</P>
<P>Set q = QueueInfo.Open</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">1,0</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> </P>
<P>Set Msg = q.Receive</P>
<P>If Not Msg Is Nothing Then</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>&#9;</FONT><FONT FACE="Arial">Response.Write "&lt;BR&gt;</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">接收到訊息</FONT><FONT FACE="Arial">LABEL:" &amp; Msg.Label</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>&#9;&#9;</FONT><FONT FACE="Arial">Response.Write "&lt;BR&gt;</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">接收到訊息</FONT><FONT FACE="Arial">LABEL:" &amp; Msg.Body</P>
<P>End If</P>
<P>%&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">學會了嗎？</P>
</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff"><P>Message Queue</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">加上</FONT><FONT FACE="Arial" SIZE=5 COLOR="#0000ff">Transaction</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff">功能</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">前面談到，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MSMQ</FONT><FONT FACE="新細明體" LANG="ZH-TW">也與</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">MTS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Transaction Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">）緊密整合，傳送的訊息可以與資料庫更動一起有「同生共死」的異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能。</P>
<P ALIGN="JUSTIFY">當資料庫的更動成功時，再傳送訊息通知其他的應用程式；資料庫的更動失敗時，訊息就不會傳送，這就是所謂的佇列異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transactional queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。</P>
<P ALIGN="JUSTIFY">譬如輸入訂單到資料庫時，若資料庫的更動成功時，就會傳送訊息通知庫房出貨，若資料庫的更動失敗時，就不會傳送訊息通知庫房。</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式當中，如何</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">加上</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">功能呢？</P>
<P ALIGN="JUSTIFY">首先於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式第一行加上</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">TRANSACTION=REQUIRED</FONT><FONT FACE="新細明體" LANG="ZH-TW">，告訴</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">這一個</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式使用異動（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">）功能的處理方式。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">Msg.Delivery = 1</FONT><FONT FACE="新細明體" LANG="ZH-TW">設定為可恢復的傳遞方式（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Recoverable Delivery</FONT><FONT FACE="新細明體" LANG="ZH-TW">）。</P>
<P ALIGN="JUSTIFY">若此</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式內所有程式執行成功時，包括更新數個資料庫和</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Message</FONT><FONT FACE="新細明體" LANG="ZH-TW">的傳送或接收，將呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">OnTransactionCommit</FONT><FONT FACE="新細明體" LANG="ZH-TW">（）副程式。若執行失敗時，譬如更新任何一個資料庫失敗，將呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">OnTransactionAbort</FONT><FONT FACE="新細明體" LANG="ZH-TW">（）副程式。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">Message Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">加上</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Transaction</FONT><FONT FACE="新細明體" LANG="ZH-TW">功能，</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%@ TRANSACTION=REQUIRED LANGUAGE=VBScript %&gt;</P>
<P>...</P>
<P>&lt;%Set QueueInfo = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"MSMQ.MSMQQueueInfo"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</P>
</FONT><FONT FACE="Arial"><P>QueueInfo.pathname = ".\test"</P>
<P>Set Queue = QueueInfo.Open</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">2, 0</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> </P>
<P>Set Msg = Server.CreateObject</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">（</FONT><FONT FACE="Arial">"MSMQ.MSMQMessage"</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">）</FONT><FONT FACE="Arial"> </P>
<P>Msg.body = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">這是</FONT><FONT FACE="Arial">message body" &amp; now</P>
<P>Msg.Label = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">這是</FONT><FONT FACE="Arial">message label" &amp; now</P>
<P>Msg.Delivery = 1 </FONT><FONT FACE="System,新細明體" LANG="ZH-TW">‘</FONT><FONT FACE="Arial">Recoverable Delivery </P>
<P>Msg.Send Queue </P>
<P>Queue.Close</P>
<P>Sub OnTransactionCommit</P>
<P>...</P>
<P>End Sub</P>
<P>Sub OnTransactionAbort</P>
<P>... </P>
<P>End Sub</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">　　</P>
</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000"><P>網站如何加入中文全文檢索功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何於您的網站加入中文全文檢索功能呢？</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，包括</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，提供中文全文檢索的搜尋功能，可以搜尋網站中</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Word </FONT><FONT FACE="新細明體" LANG="ZH-TW">或</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Excel</FONT><FONT FACE="新細明體" LANG="ZH-TW">檔案、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">text</FONT><FONT FACE="新細明體" LANG="ZH-TW">、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">html</FONT><FONT FACE="新細明體" LANG="ZH-TW">、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">等檔案格式內的資料。</P>
<P ALIGN="JUSTIFY">本單元教您如何搜尋特定目錄下的資料。</P>
<P ALIGN="JUSTIFY">若要執行中文全文檢索的範例，首先安裝</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Microsoft Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，然後於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Index Server Manager</FONT><FONT FACE="新細明體" LANG="ZH-TW">建立一個名為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ntop</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Catalog</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">方法為執行</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Index Server Manager</FONT><FONT FACE="新細明體" LANG="ZH-TW">，於</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Index Server on Local Machine] </FONT><FONT FACE="新細明體" LANG="ZH-TW">按右鍵，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[New] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Catalog]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">接著將</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Catalog</FONT><FONT FACE="新細明體" LANG="ZH-TW">命名為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ntop</FONT><FONT FACE="新細明體" LANG="ZH-TW">，選擇範例安裝的路徑，建立待搜查的目錄，於所新建立的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ntop Catalog</FONT><FONT FACE="新細明體" LANG="ZH-TW">，按右鍵，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[New] </FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Directory]</FONT><FONT FACE="新細明體" LANG="ZH-TW">，輸入待搜查的目錄，最後要啟動</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">，於</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Index Server on Local Machine] </FONT><FONT FACE="新細明體" LANG="ZH-TW">按右鍵，選擇</FONT> <FONT FACE="System,新細明體" LANG="ZH-TW">[Start]</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">於用戶端使用瀏覽器執行，輸入搜尋字串</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">index</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">所找到的標題為本範例的</FONT>&lt;<FONT FACE="System,新細明體" LANG="ZH-TW">TITLE&gt;</FONT><FONT FACE="新細明體" LANG="ZH-TW">您找到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Index Server</FONT><FONT FACE="新細明體" LANG="ZH-TW">了</FONT>&lt;<FONT FACE="System,新細明體" LANG="ZH-TW">/TITLE&gt;</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">如何於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式加入中文全文檢索功能呢？首先</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">set Q = Server.CreateObject</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"ixsso.Query"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）以呼叫中文全文檢索的元件，然後設定：</P>

<UL>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Q.Query = </FONT><FONT FACE="新細明體" LANG="ZH-TW">搜尋字串</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Q.SortBy = </FONT><FONT FACE="新細明體" LANG="ZH-TW">排列順序</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Q.Columns = </FONT><FONT FACE="新細明體" LANG="ZH-TW">搜尋的欄位</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>Q.Catalog = </FONT><FONT FACE="新細明體" LANG="ZH-TW">搜尋的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Catalog</LI></P>
<P ALIGN="JUSTIFY"><LI>Q.MaxRecords = </FONT><FONT FACE="新細明體" LANG="ZH-TW">最多搜尋筆數</FONT> </LI></P></UL>

<FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">最後下一行</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Q.CreateRecordSet</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"nonsequential"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）後即開始搜尋，搜尋的結果放在</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Recordset</FONT><FONT FACE="新細明體" LANG="ZH-TW">中，如下：</P>

<UL>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS.RecordCount</FONT><FONT FACE="新細明體" LANG="ZH-TW">：搜尋相符的筆數。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"rank"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：搜尋相符率，最大為</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">1000</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"DocTitle"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：標題。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"vpath"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">URL</FONT><FONT FACE="新細明體" LANG="ZH-TW">位址。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"characterization"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：摘要。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"size"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：檔案大小。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"filename"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：檔案名稱。</LI></P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>RS</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"write"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）：檔案寫入日期時間。</LI></P></UL>

<P ALIGN="JUSTIFY">完整的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;HTML&gt;&lt;HEAD&gt;</P>
<P>&lt;TITLE&gt;</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">您找到</FONT><FONT FACE="Arial">Index Server</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">了</FONT><FONT FACE="Arial">&lt;/TITLE&gt;</P>
<P>&lt;/HEAD&gt;</P>
<P>&lt;BODY&gt;</P>
<P>&lt;%</P>
<P>if Request("Action") = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">搜尋</FONT><FONT FACE="Arial">" then</P>
<P>set Q = Server.CreateObject("ixsso.Query")</P>
<P>Q.Query = Request("SearchString")</P>
<P>Q.SortBy = "rank[d]"</P>
<P>Q.Columns = "DocTitle, vpath, filename, size, write, </P>
<P>characterization, rank"</P>
<P>Q.MaxRecords = 50 </P>
<P>Q.Catalog = "ntop"</P>
<P>set rs = Q.CreateRecordSet("nonsequential")</P>
<P>Response.Write "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">總計</FONT><FONT FACE="Arial"> " &amp; rs.RecordCount &amp; " </FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">項</FONT><FONT FACE="Arial">&lt;p&gt;"</P>
<P>%&gt;</P>
<P>&lt;% Do While Not rs.EOF %&gt;</P>
<P>&lt;%if VarType(rs("DocTitle")) = 1 or rs("DocTitle") = "" then%&gt;</P>
<P>&#9;&lt;a href="&lt;%=rs("vpath")%&gt;"&gt;&lt;%= </P>
<P>Server.HTMLEncode( rs("filename") )%&gt;&lt;/a&gt; (&lt;%= rs("rank") %&gt;)</P>
<P>&lt;%else%&gt;</P>
<P>&#9;&lt;a href="&lt;%=rs("vpath")%&gt;"&gt;&lt;%= Server.HTMLEncode(rs("DocTitle"))%&gt;&lt;/a&gt; (&lt;%= rs("rank") %&gt;)</P>
<P>&lt;%end if%&gt;</P>
<P>&lt;BR&gt;</P>
<P>&lt;%if VarType(rs("characterization")) = 8 and rs("characterization") &lt;&gt; "" then%&gt;</P>
<P>&#9;</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">摘要</FONT><FONT FACE="Arial">:&lt;%= Server.HTMLEncode(rs("characterization"))%&gt;&lt;br&gt;</P>
<P>&lt;%end if%&gt;</P>
<P>http://&lt;%=Request("server_name")%&gt;&lt;%=rs("vpath")%&gt;&lt;br&gt;</P>
<P>&lt;%if not rs("size") = "" then%&gt;</P>
<P>size &lt;%=rs("size")%&gt; bytes - &lt;%=rs("write")%&gt; GMT</P>
<P>&lt;%end if%&gt;</P>
<P>&lt;P&gt;</P>
<P>&lt;%</P>
<P>rs.MoveNext</P>
<P>Loop</P>
<P>end if</P>
<P>%&gt;</P>
<P>&lt;hr&gt;</P>
<P>&lt;FORM ACTION="index1.asp" METHOD=GET&gt;</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>搜尋字串</FONT><FONT FACE="Arial">:</P>
<P>&lt;INPUT TYPE="TEXT" NAME="SearchString" SIZE="30" VALUE="&lt;% = Request("SearchString") %&gt;"&gt;&lt;/TD&gt;</P>
<P>&lt;INPUT TYPE="SUBMIT" NAME="Action" VALUE="</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">搜尋</FONT><FONT FACE="Arial">"&gt;</P>
<P>&lt;/FORM&gt;</P>
<P>&lt;HR&gt;&lt;/BODY&gt;&lt;/HTML&gt;</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="全真中隸書,???" LANG="ZH-TW" SIZE=6 COLOR="#ff0000"><P>網站如何加入郵件傳送功能呢？</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">如何於您的網站加入郵件傳送功能呢？</P>
<P ALIGN="JUSTIFY">於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">當中，包括</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SMTP Service</FONT><FONT FACE="新細明體" LANG="ZH-TW">，提供郵件傳送的功能。因此若要執行郵件傳送的範例，須安裝</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Windows NT Option Pack</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SMTP Service</FONT><FONT FACE="新細明體" LANG="ZH-TW">。</P>
<P ALIGN="JUSTIFY">如何於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式加入</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SMTP Service</FONT><FONT FACE="新細明體" LANG="ZH-TW">郵件傳送功能呢？首先</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Set mail1 = Server.CreateObject</FONT><FONT FACE="新細明體" LANG="ZH-TW">（</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"CDONTS.NewMail"</FONT><FONT FACE="新細明體" LANG="ZH-TW">）以呼叫</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">SMTP Service</FONT><FONT FACE="新細明體" LANG="ZH-TW">的元件，然後設定：</P>

<UL>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"><LI>mail1.To = “</FONT><FONT FACE="新細明體" LANG="ZH-TW">收件者</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">E-Mail</FONT><FONT FACE="新細明體" LANG="ZH-TW">位址</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"</LI></P>
<P ALIGN="JUSTIFY"><LI>mail1.From = "</FONT><FONT FACE="新細明體" LANG="ZH-TW">寄件者</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">E-Mail</FONT><FONT FACE="新細明體" LANG="ZH-TW">位址</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">" </LI></P>
<P ALIGN="JUSTIFY"><LI>mail1.Subject = "</FONT><FONT FACE="新細明體" LANG="ZH-TW">主旨</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">"</LI></P>
<P ALIGN="JUSTIFY"><LI>mail1.Body = “E-Mail</FONT><FONT FACE="新細明體" LANG="ZH-TW">內文</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">”</LI></P></UL>

</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">最後下</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mail1.Send</FONT><FONT FACE="新細明體" LANG="ZH-TW">即開始傳送郵件。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">asp</FONT><FONT FACE="新細明體" LANG="ZH-TW">程式，如下：</P>
</FONT><FONT FACE="Arial"><P>&lt;%</P>
<P>Set mail1 = Server.CreateObject("CDONTS.NewMail")</P>
<P>mail1.To = "abc@xxx.com"</P>
<P>mail1.From = "jackchou@tpts5.seed.net.tw" </P>
<P>mail1.Subject = "</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">主旨</FONT><FONT FACE="Arial">"</P>
<P>mail1.Body = "E-Mail</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW">內文</FONT><FONT FACE="Arial">" </P>
<P>mail1.Send</P>
<P>%&gt;</P>
</FONT><FONT FACE="華康中楷體,???" LANG="ZH-TW"><P>郵件傳送</FONT><FONT FACE="Arial">ok! </P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">最後一行下了</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mail1.Send</FONT><FONT FACE="新細明體" LANG="ZH-TW">後即開始傳送郵件。</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">SMTP Service</FONT><FONT FACE="新細明體" LANG="ZH-TW">將待傳送郵件先送到到</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mailroot</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">目錄下，然後再傳送出去，若傳不出去則放置於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mailroot</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Badmail</FONT><FONT FACE="新細明體" LANG="ZH-TW">目錄下。</P>
<P ALIGN="JUSTIFY">執行後於</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Mailroot</FONT><FONT FACE="新細明體" LANG="ZH-TW">的</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Queue</FONT><FONT FACE="新細明體" LANG="ZH-TW">目錄下，可以看到此封待傳送的電子郵件。</P>
<P ALIGN="JUSTIFY">　</P>
</FONT><FONT FACE="標楷體" LANG="ZH-TW" SIZE=5 COLOR="#0000ff"><P>網站設計參考資料</P>
</FONT><FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">作者準備一個展示各種</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS 4.0</FONT><FONT FACE="新細明體" LANG="ZH-TW">設計實例的網站，提供各種網站網頁的資訊、與設計範例，包括</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">IIS</FONT><FONT FACE="新細明體" LANG="ZH-TW">特異功能、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">Web</FONT><FONT FACE="新細明體" LANG="ZH-TW">資料庫設計實例、網路商店、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ActiveX</FONT><FONT FACE="新細明體" LANG="ZH-TW">、推播頻道、動態</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">HTML</FONT><FONT FACE="新細明體" LANG="ZH-TW">、</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">HTML 99</FONT><FONT FACE="新細明體" LANG="ZH-TW">招等，網址如下：</P>
</FONT><FONT FACE="System,新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY"></FONT><A HREF="../../index.html"><FONT FACE="System,新細明體" LANG="ZH-TW">http://www.asp.com.tw</FONT></A></P>
<FONT FACE="新細明體" LANG="ZH-TW"><P ALIGN="JUSTIFY">歡迎上網光臨指教。</P>
<P ALIGN="JUSTIFY">另外筆者最新著作為「</FONT><FONT FACE="System,新細明體" LANG="ZH-TW">ASP</FONT><FONT FACE="新細明體" LANG="ZH-TW">網站熱門應用技術</FONT><FONT FACE="標楷體" LANG="ZH-TW">」</FONT><FONT FACE="新細明體" LANG="ZH-TW">、「微軟熱門Web技術速成班」，對網站的技術提供更多的探討，歡迎參考。</P>
<P ALIGN="JUSTIFY">　</P>
<P ALIGN="JUSTIFY">　</P></FONT></BODY>
</HTML>
